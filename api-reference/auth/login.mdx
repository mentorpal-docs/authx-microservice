# User Login

Authenticate a user and receive access and refresh tokens.

## Endpoint

```
POST /api/v1/auth/login
```

## Description

Authenticates a user with email and password. Returns JWT access token and refresh token on successful authentication.

## Rate Limiting

- **Limit:** 5 requests per 15 minutes
- **Window:** 15 minutes
- **Identifier:** Email address

## Request

<ParamField body="email" type="string" required>
  User's email address
</ParamField>

<ParamField body="password" type="string" required>
  User's password
</ParamField>

<ParamField body="deviceInfo" type="object" optional>
  Device information (tracked for audit logging)
  
  ```json
  {
    "userAgent": "Mozilla/5.0...",
    "ipAddress": "192.168.1.1"
  }
  ```
</ParamField>

## Request Body

```json
{
  "email": "john.doe@example.com",
  "password": "SecurePass123!"
}
```

## Response

### Success (200)

```json
{
  "success": true,
  "message": "Login successful",
  "data": {
    "user": {
      "_id": "507f1f77bcf86cd799439011",
      "email": "john.doe@example.com",
      "firstName": "John",
      "lastName": "Doe",
      "role": "user",
      "isActive": true
    },
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "507f1f77bcf86cd799439012"
  }
}
```

### Invalid Credentials (401)

```json
{
  "success": false,
  "message": "Invalid email or password",
  "code": "INVALID_CREDENTIALS"
}
```

### Account Locked (403)

```json
{
  "success": false,
  "message": "Account locked due to multiple failed login attempts",
  "code": "ACCOUNT_LOCKED",
  "lockedUntil": "2025-11-23T11:00:00.000Z"
}
```

### Rate Limited (429)

```json
{
  "success": false,
  "message": "Too many login attempts. Please try again later.",
  "retryAfter": 900
}
```

## Examples

<Tabs>
  <Tab title="cURL">
    ```bash
    curl -X POST http://localhost:3000/api/v1/auth/login \
      -H "Content-Type: application/json" \
      -d '{
        "email": "john.doe@example.com",
        "password": "SecurePass123!"
      }'
    ```
  </Tab>

  <Tab title="JavaScript">
    ```javascript
    const response = await fetch('http://localhost:3000/api/v1/auth/login', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        email: 'john.doe@example.com',
        password: 'SecurePass123!'
      })
    });

    const data = await response.json();
    
    if (data.success) {
      const { accessToken, refreshToken } = data.data;
      
      // Store tokens
      localStorage.setItem('accessToken', accessToken);
      localStorage.setItem('refreshToken', refreshToken);
    }
    ```
  </Tab>

  <Tab title="Axios">
    ```javascript
    const axios = require('axios');

    try {
      const response = await axios.post(
        'http://localhost:3000/api/v1/auth/login',
        {
          email: 'john.doe@example.com',
          password: 'SecurePass123!'
        }
      );

      const { accessToken, refreshToken } = response.data.data;
    } catch (error) {
      if (error.response?.status === 403) {
        console.log('Account locked');
      }
    }
    ```
  </Tab>
</Tabs>

## Security Notes

- Account locks after 5 failed login attempts (30-minute lockout)
- Always use HTTPS in production
- Don't store passwords in plain text
- Use strong passwords (enforce on client-side validation)
- Implement account recovery for locked accounts

## Next Steps

After login:
1. [Get profile](../user/get-profile) to retrieve user info
2. [Refresh token](./refresh-token) when access token expires
3. [Change password](./change-password) to update password
